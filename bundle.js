!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=2)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e,i,n){this.r=t,this.g=e,this.b=i,this.a=n}static average(t){const e=t.reduce((t,e)=>new n(t.r+e.r,t.g+e.g,t.b+e.b,t.a+e.a),new n(0,0,0,0));return new n(e.r/t.length,e.g/t.length,e.b/t.length,e.a/t.length)}equals(t){return this.r===t.r&&this.g===t.g&&this.b===t.b&&this.a===t.a}}e.Colour=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class n{constructor(t,e,i){this.x=t,this.y=e,this.z=i}isTheZeroVector(){return 0===this.x&&0===this.y&&0===this.z}subtract(t){return new n(this.x-t.x,this.y-t.y,this.z-t.z)}add(t){return new n(this.x+t.x,this.y+t.y,this.z+t.z)}crossProduct(t){return new n(this.y*t.z-this.z*t.y,this.z*t.x-this.x*t.z,this.x*t.y-this.y*t.x)}dotProduct(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateInYAround(t,e){const i=new n(t.x,t.y,t.z),o=this.subtract(i);return new n(o.x*Math.cos(e)-o.z*Math.sin(e),o.y,o.z*Math.cos(e)+o.x*Math.sin(e)).add(i)}distanceTo(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2)+Math.pow(this.z-t.z,2))}}e.Vector=n},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(3);document.addEventListener("DOMContentLoaded",()=>{(new n.AnimationLoop).start()},!1)},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(4),o=i(5),s=i(0),r=i(1);e.AnimationLoop=class{constructor(){this.width=500,this.height=500,this.canvas=new n.Canvas(this.width,this.height),this.scene=new o.Scene,this.timestamp=new Date,this.timestampElement=document.getElementById("timestamp")}start(){this.tick()}tick(){const t=new Date;let e=1e3/(t.getTime()-this.timestamp.getTime());e=Math.floor(100*e)/100,this.timestampElement.textContent=e.toString(),this.timestamp=t,this.scene.update();const i=this.generateImage();this.canvas.paint(i),setTimeout(()=>{this.tick()},0)}generateImage(){const t=[];for(let e=0;e<this.height;e++){const i=this.generateImageRow(e);t.push(i)}return t}generateImageRow(t){const e=[];for(let i=0;i<this.width;i++){if(t%4!=0||i%4!=0){e.push(new s.Colour(0,0,0,1));continue}const n=this.colourAtEndOfRay(t,i);e.push(n)}return e}colourAtEndOfRay(t,e){let i=new s.Colour(0,0,0,1),n=1/0;return this.scene.getTriangles().forEach(o=>{const s=this.getWindingNumber(t,e,o);s&&s<n&&(i=o.colour,n=s)}),i}getWindingNumber(t,e,i){let n=0;const o=[i.point0,i.point1,i.point2];for(let i=0;i<3;i++){const s=o[i],h=o[(i+1)%3];s.y<=e?h.y>e&&this.isLeft(s,h,new r.Vector(t,e,0))>0&&n++:h.y<=e&&this.isLeft(s,h,new r.Vector(t,e,0))<0&&n--}return n?i.calculateZ(t,e):null}isLeft(t,e,i){return(e.x-t.x)*(i.y-t.y)-(i.x-t.x)*(e.y-t.y)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(0);e.Canvas=class{constructor(t,e){const i=document.getElementById("canvas");if(!i)throw new Error("couldn't find 'canvas' on document");this.canvas=i;const o=i.getContext("2d");if(!o)throw new Error("could not get canvas context");this.ctx=o,this.canvas.width=t,this.canvas.height=e,this.previousImage=[];for(let t=0;t<this.canvas.width;t++){const t=[];for(let e=0;e<this.canvas.height;e++)t.push(new n.Colour(0,0,0,0));this.previousImage.push(t)}}paint(t){for(let e=0;e<t.length;e++)for(let i=0;i<t[e].length;i++){if(this.previousImage[e][i].equals(t[e][i]))continue;const n=t[e][i];this.ctx.fillStyle="rgba("+n.r+","+n.g+","+n.b+","+n.a+")",this.ctx.fillRect(e,i,1,1)}this.previousImage=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(1),o=i(6);e.Scene=class{constructor(){this.drawables=[];const t=new n.Vector(250,100,100),e=new n.Vector(250,200,200),i=e.rotateInYAround(t,2*Math.PI/3),s=i.rotateInYAround(t,2*Math.PI/3);this.drawables.push(new o.Parallelepiped(t,e,i,s,(function(){this.rotate()})))}getTriangles(){return this.drawables.map(t=>t.getTriangles()).reduce((t,e)=>t.concat(e),[])}update(){this.drawables.forEach(t=>t.update())}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=i(7),o=i(0);e.Parallelepiped=class{constructor(t,e,i,n,o=(()=>{})){this.point0=t,this.point1=e,this.point2=i,this.point3=n;const s=e.subtract(t),r=i.subtract(t),h=n.subtract(t);this.point12=t.add(s).add(r),this.point13=t.add(s).add(h),this.point23=t.add(r).add(h),this.point123=t.add(s).add(r).add(h),this.update=o}getTriangles(){return[new n.Triangle(this.point0,this.point12,this.point2,new o.Colour(255,0,0,1)),new n.Triangle(this.point0,this.point1,this.point12,new o.Colour(255,0,0,1)),new n.Triangle(this.point0,this.point13,this.point1,new o.Colour(0,255,0,1)),new n.Triangle(this.point0,this.point3,this.point13,new o.Colour(0,255,0,1)),new n.Triangle(this.point0,this.point23,this.point3,new o.Colour(0,0,255,1)),new n.Triangle(this.point0,this.point2,this.point23,new o.Colour(0,0,255,1)),new n.Triangle(this.point3,this.point123,this.point13,new o.Colour(0,255,255,1)),new n.Triangle(this.point3,this.point23,this.point123,new o.Colour(0,255,255,1)),new n.Triangle(this.point2,this.point123,this.point23,new o.Colour(255,0,255,1)),new n.Triangle(this.point2,this.point12,this.point123,new o.Colour(255,0,255,1)),new n.Triangle(this.point1,this.point123,this.point12,new o.Colour(255,255,0,1)),new n.Triangle(this.point1,this.point13,this.point123,new o.Colour(255,255,0,1))]}rotate(){this.point0=this.point0.rotateInYAround(this.point0,.01),this.point1=this.point1.rotateInYAround(this.point0,.01),this.point2=this.point2.rotateInYAround(this.point0,.01),this.point3=this.point3.rotateInYAround(this.point0,.01),this.point12=this.point12.rotateInYAround(this.point0,.01),this.point13=this.point13.rotateInYAround(this.point0,.01),this.point23=this.point23.rotateInYAround(this.point0,.01),this.point123=this.point123.rotateInYAround(this.point0,.01)}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Triangle=class{constructor(t,e,i,n,o=(()=>{})){if(this.point0=t,this.point1=e,this.point2=i,this.colour=n,this.update=o,this.normal=e.subtract(t).crossProduct(i.subtract(t)),this.normal.isTheZeroVector())throw new Error("This triangle would be degenerate")}getTriangles(){return[this]}calculateZ(t,e){const i=this.normal.x,n=this.normal.y,o=this.normal.z;return 1/o*(i*this.point0.x+n*this.point0.y)+this.point0.z+-i/o*t+-n/o*e}rotateAround(t){this.point0=this.point0.rotateInYAround(t,.01),this.point1=this.point1.rotateInYAround(t,.01),this.point2=this.point2.rotateInYAround(t,.01)}}}]);
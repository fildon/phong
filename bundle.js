!function(t){var e={};function n(s){if(e[s])return e[s].exports;var i=e[s]={i:s,l:!1,exports:{}};return t[s].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,s){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(n.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(s,i,function(e){return t[e]}.bind(null,i));return s},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=2)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Point=class{constructor(t,e,n){this.x=t,this.y=e,this.z=n}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Colour=class{constructor(t,e,n,s){this.r=t,this.g=e,this.b=n,this.a=s}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=n(3);document.addEventListener("DOMContentLoaded",()=>{(new s.AnimationLoop).start()},!1)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=n(4),i=n(5),o=n(1),r=n(0);e.AnimationLoop=class{constructor(){this.width=500,this.height=500,this.canvas=new s.Canvas(this.width,this.height),this.scene=new i.Scene,this.timestamp=new Date,this.timestampElement=document.getElementById("timestamp")}start(){this.tick()}tick(){const t=new Date;let e=1e3/(t.getTime()-this.timestamp.getTime());e=Math.floor(100*e)/100,this.timestampElement.textContent=e.toString(),this.timestamp=t,this.scene.update();const n=this.generateImage();this.canvas.paint(n),setTimeout(()=>{this.tick()},0)}generateImage(){const t=[];for(let e=0;e<this.height;e++){const n=this.generateImageRow(e);t.push(n)}return t}generateImageRow(t){const e=[];for(let n=0;n<this.width;n++){const s=this.generateColourAt(t,n);e.push(s)}return e}generateColourAt(t,e){let n=new o.Colour(0,0,0,1),s=1/0;return this.scene.getPolys().forEach(i=>{const o=this.getWindingResult(t,e,i);o&&o<s&&(n=i.colour,s=o)}),n}getWindingResult(t,e,n){let s=0;const i=n.points.length;for(let o=0;o<i;o++){const c=n.points[o],u=n.points[(o+1)%i];c.y<=e?u.y>e&&this.isLeft(c,u,new r.Point(t,e,0))>0&&s++:u.y<=e&&this.isLeft(c,u,new r.Point(t,e,0))<0&&s--}return s?n.calculateZ(t,e):null}isLeft(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Canvas=class{constructor(t,e){const n=document.getElementById("canvas");if(!n)throw new Error("couldn't find 'canvas' on document");this.canvas=n;const s=n.getContext("2d");if(!s)throw new Error("could not get canvas context");this.ctx=s,this.canvas.width=t,this.canvas.height=e}paint(t){for(let e=0;e<t.length;e++)for(let n=0;n<t[e].length;n++){const s=t[e][n];this.ctx.fillStyle="rgba("+s.r+","+s.g+","+s.b+","+s.a+")",this.ctx.fillRect(e,n,1,1)}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=n(6),i=n(0),o=n(1);e.Scene=class{constructor(){this.drawables=[],this.drawables.push(new s.Poly([new i.Point(100,100,100),new i.Point(200,300,80),new i.Point(300,100,200)],new o.Colour(255,0,0,1),(function(){this.points[0].x=(this.points[0].x+1)%500,this.points[0].y=(this.points[0].y+1)%500,this.points[0].z=(this.points[0].z+1)%500}))),this.drawables.push(new s.Poly([new i.Point(100,300,100),new i.Point(200,100,100),new i.Point(300,300,100)],new o.Colour(0,255,0,1)))}getPolys(){return this.drawables.map(t=>t.getPolys()).reduce((t,e)=>t.concat(e),[])}update(){this.drawables.forEach(t=>t.update())}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Poly=class{constructor(t,e,n=(()=>{})){if(t.length<3)throw new Error("too few points to define poly");this.points=t,this.colour=e,this.update=n}getPolys(){return[this]}calculateZ(t,e){let n=[this.points[0].x-this.points[1].x,this.points[0].y-this.points[1].y,this.points[0].z-this.points[1].z],s=[this.points[0].x-this.points[2].x,this.points[0].y-this.points[2].y,this.points[0].z-this.points[2].z],i=n[1]*s[2]-n[2]*s[1],o=n[2]*s[0]-n[0]*s[2],r=n[0]*s[1]-n[1]*s[0];return 1/r*(i*this.points[0].x+o*this.points[0].y)+this.points[0].z+-i/r*t+-o/r*e}}}]);